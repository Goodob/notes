<!DOCTYPE html>
<html>
<head>
<title>Linux 基础教程</title>
<!-- 2017-03-21 周二 10:58 -->
<meta  charset="utf-8">
<meta  name="generator" content="Org-mode">
<meta  name="author" content="imfine">
<link rel="stylesheet" href="nnn.css">
<meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="index.html"> UP </a>
 |
 <a accesskey="H" href="index.html"> HOME </a>
</div><div id="content">
<h1 class="title">Linux 基础教程</h1>
<nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. 虚拟机</a>
<ul>
<li><a href="#sec-1-1">1.1. VirtualBox</a></li>
<li><a href="#sec-1-2">1.2. VMWare Station</a></li>
</ul>
</li>
<li><a href="#sec-2">2. 常用的命令</a>
<ul>
<li><a href="#sec-2-1">2.1. 文档</a></li>
<li><a href="#sec-2-2">2.2. ls(list)</a></li>
<li><a href="#sec-2-3">2.3. passwd</a></li>
<li><a href="#sec-2-4">2.4. su</a></li>
<li><a href="#sec-2-5">2.5. sudo</a></li>
<li><a href="#sec-2-6">2.6. gedit</a></li>
<li><a href="#sec-2-7">2.7. cp(copy)</a></li>
<li><a href="#sec-2-8">2.8. rm(remove)</a></li>
<li><a href="#sec-2-9">2.9. mkdir/rmdir</a></li>
<li><a href="#sec-2-10">2.10. cat/head/tail/more/less</a></li>
<li><a href="#sec-2-11">2.11. grep</a></li>
<li><a href="#sec-2-12">2.12. find</a></li>
<li><a href="#sec-2-13">2.13. tar/zip</a></li>
<li><a href="#sec-2-14">2.14. 任务相关</a></li>
</ul>
</li>
<li><a href="#sec-3">3. 程序安装</a>
<ul>
<li><a href="#sec-3-1">3.1. apt-get update</a></li>
<li><a href="#sec-3-2">3.2. apt-cache search</a></li>
<li><a href="#sec-3-3">3.3. apt-get install</a></li>
</ul>
</li>
<li><a href="#sec-4">4. 用户与权限</a>
<ul>
<li><a href="#sec-4-1">4.1. chown</a></li>
<li><a href="#sec-4-2">4.2. chgrp</a></li>
<li><a href="#sec-4-3">4.3. groups</a></li>
<li><a href="#sec-4-4">4.4. chmod</a></li>
</ul>
</li>
<li><a href="#sec-5">5. JDK 的安装</a>
<ul>
<li><a href="#sec-5-1">5.1. 安装 OpenJDK</a></li>
<li><a href="#sec-5-2">5.2. 安装 OracleJDK</a>
<ul>
<li><a href="#sec-5-2-1">5.2.1. 第 0 步，下载</a></li>
<li><a href="#sec-5-2-2">5.2.2. 第 1 步，解压到相应目录(<i>opt</i>)</a></li>
<li><a href="#sec-5-2-3">5.2.3. 第 2 步，设置环境变量</a></li>
<li><a href="#sec-5-2-4">5.2.4. All In All</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-6">6. Tomcat 的安装</a>
<ul>
<li><a href="#sec-6-1">6.1. 手动安装</a></li>
<li><a href="#sec-6-2">6.2. apt 方式安装</a></li>
</ul>
</li>
<li><a href="#sec-7">7. Tomcat 的基本概念</a></li>
<li><a href="#sec-8">8. Tomcat 下的文件部署</a>
<ul>
<li><a href="#sec-8-1">8.1. 将符合 war 标准的文件夹或 .war 文件直接放置到 webapps 下面</a></li>
<li><a href="#sec-8-2">8.2. 修改配置文件，设置 Context</a></li>
<li><a href="#sec-8-3">8.3. 使用 Tomcat 提供的 Admin 管理</a></li>
</ul>
</li>
</ul>
</div>
</nav>


<section id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> 虚拟机</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> VirtualBox</h3>
</div>
<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> VMWare Station</h3>
<div class="outline-text-3" id="text-1-2">
<p>
安装步骤
</p>
</div>
</div>
</section>

<section id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> 常用的命令</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> 文档</h3>
<div class="outline-text-3" id="text-2-1">
<p>
&#x2013;help
</p>

<p>
man(manual)
</p>

<p>
info(information)
</p>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> ls(list)</h3>
<div class="outline-text-3" id="text-2-2">
<p>
用来列出文件夹的内容
</p>
</div>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3"><span class="section-number-3">2.3</span> passwd</h3>
<div class="outline-text-3" id="text-2-3">
<p>
更改用户密码
</p>
</div>
</div>

<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4"><span class="section-number-3">2.4</span> su</h3>
<div class="outline-text-3" id="text-2-4">
<p>
切换到超级用户
</p>
</div>
</div>

<div id="outline-container-sec-2-5" class="outline-3">
<h3 id="sec-2-5"><span class="section-number-3">2.5</span> sudo</h3>
<div class="outline-text-3" id="text-2-5">
<p>
临时切换到超级用户并做一些操作。操作完成之后返回原先用户的环境。
</p>
</div>
</div>

<div id="outline-container-sec-2-6" class="outline-3">
<h3 id="sec-2-6"><span class="section-number-3">2.6</span> gedit</h3>
<div class="outline-text-3" id="text-2-6">
<p>
linux 之下存在的一个简单编辑器，类似于 windows 下面的 notepad
</p>

<pre class="example">
sudo gedit /etc/apt/sources.list
</pre>

<pre class="example">
su
vim /etc/apt/sources.list
</pre>
</div>
</div>

<div id="outline-container-sec-2-7" class="outline-3">
<h3 id="sec-2-7"><span class="section-number-3">2.7</span> cp(copy)</h3>
<div class="outline-text-3" id="text-2-7">
<pre class="example">
cp /etc/apt/sources.list ~/sources.list
</pre>
</div>
</div>


<div id="outline-container-sec-2-8" class="outline-3">
<h3 id="sec-2-8"><span class="section-number-3">2.8</span> rm(remove)</h3>
<div class="outline-text-3" id="text-2-8">
<pre class="example">
rm -rf / ttt  # 要不得
</pre>
</div>
</div>

<div id="outline-container-sec-2-9" class="outline-3">
<h3 id="sec-2-9"><span class="section-number-3">2.9</span> mkdir/rmdir</h3>
<div class="outline-text-3" id="text-2-9">
<p>
mkdir 是用来创建文件
</p>

<p>
rmdir 默认只能删除空的文件夹，如果想要删除文件夹连带下面内容的话，那么用 rm -r dir 来表示。这是为了安全！
</p>
</div>
</div>

<div id="outline-container-sec-2-10" class="outline-3">
<h3 id="sec-2-10"><span class="section-number-3">2.10</span> cat/head/tail/more/less</h3>
<div class="outline-text-3" id="text-2-10">
<p>
查看文件内容
</p>
</div>
</div>

<div id="outline-container-sec-2-11" class="outline-3">
<h3 id="sec-2-11"><span class="section-number-3">2.11</span> grep</h3>
<div class="outline-text-3" id="text-2-11">
<p>
用来过滤内容，可以使用正则表达式。经常跟 "|" 通道结合使用。例如：
</p>
<pre class="example">
ls /etc | grep "java"
</pre>
<p>
表示的是，显示 /etc 文件夹下名字中包含 "java" 字符串的文件夹
</p>
</div>
</div>

<div id="outline-container-sec-2-12" class="outline-3">
<h3 id="sec-2-12"><span class="section-number-3">2.12</span> find</h3>
<div class="outline-text-3" id="text-2-12">
<p>
用来查找某个文件夹下面的内容。即搜索。
</p>

<p>
比如，我们想查找 /etc 下面所有的 xml 文件，语法为:
</p>
<pre class="example">
find /etc -type f -name "*.xml"
</pre>

<p>
其他内容，请自行 man
</p>
</div>
</div>

<div id="outline-container-sec-2-13" class="outline-3">
<h3 id="sec-2-13"><span class="section-number-3">2.13</span> tar/zip</h3>
<div class="outline-text-3" id="text-2-13">
<p>
要想把一堆文件归档成一个单独的文件（方便管理），需要用到 tar 命令:
</p>
<pre class="example">
tar -c -f xxx.tar a.txt b.txt c.txt
tar -cf xxx.tar *.txt
tar cf xxx.tar *.txt
</pre>

<p>
tar 命令，只是把分散的文件，拼接成一个完整的文件，但没有做任何的压缩处理。
</p>


<p>
如果想压缩的话，就需要用到相关的压缩命令。拿 gzip 来示例：
</p>
<pre class="example">
gzip xxx.tar
</pre>


<p>
如果，想一步到位，压缩加归档的话：
</p>
<pre class="example">
tar --create --verbose --zip --file xxx.tar.gz a.txt b.txt c.txt
tar czvf xxx.tar.gz *.txt
</pre>

<p>
如果想要解压的话：
</p>
<pre class="example">
tar xzvf xxx.tar.gz
</pre>
</div>
</div>




<div id="outline-container-sec-2-14" class="outline-3">
<h3 id="sec-2-14"><span class="section-number-3">2.14</span> 任务相关</h3>
<div class="outline-text-3" id="text-2-14">
<p>
将当前任务挂起，即放到后台
</p>
<pre class="example">
Ctrl-Z
</pre>

<p>
命令行下，查看所有被挂起的后台任务
</p>
<pre class="example">
jobs
</pre>

<p>
将挂起的某个任务，放置到前台
</p>
<pre class="example">
fg [任务编号]
</pre>

<p>
将程序以后台的方式打开，只需要在命令最后添加
</p>
<pre class="example">
&amp;
</pre>
</div>
</div>
</section>

<section id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> 程序安装</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> apt-get update</h3>
<div class="outline-text-3" id="text-3-1">
<p>
读取 sources.list 里面的地址，把所有可用软件的目录更新到本地
</p>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> apt-cache search</h3>
<div class="outline-text-3" id="text-3-2">
<p>
从本地目录中，查询相关的软件。支持正则表达式。
</p>
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3"><span class="section-number-3">3.3</span> apt-get install</h3>
<div class="outline-text-3" id="text-3-3">
<p>
讲软件下载到本地
</p>

<p>
比如，下载 git
</p>
<div class="org-src-container">

<pre class="src src-sh">apt-get update           <span style="color: #b22222;"># </span><span style="color: #b22222;">&#22312;&#27599;&#27425;&#36827;&#34892;&#36719;&#20214;&#19979;&#36733;&#21069;&#65292;&#20859;&#25104;&#38543;&#25163; update &#30340;&#20064;&#24815;</span>
apt-cache search <span style="color: #8b2252;">"^git"</span>  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#26597;&#35810; git &#36719;&#20214;</span>
apt-get install git      <span style="color: #b22222;"># </span><span style="color: #b22222;">&#23545; git &#36827;&#34892;&#23433;&#35013;</span>

git clone https://github.com/s126/notes  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20811;&#38534;&#25105;&#20204;&#30340;&#31508;&#35760;</span>
</pre>
</div>
</div>
</div>
</section>
<section id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> 用户与权限</h2>
<div class="outline-text-2" id="text-4">
<p>
文件的基本权限有:
</p>
<ol class="org-ol">
<li>Read (读)
</li>
<li>Write (写)
</li>
<li>eXecute (执行)
</li>
</ol>

<p>
设置权限的层次：
</p>
<ol class="org-ol">
<li>Owner (拥有者)
</li>
<li>Group (组)
</li>
<li>Others (其他人)
</li>
</ol>
</div>

<div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> chown</h3>
<div class="outline-text-3" id="text-4-1">
<p>
更改文件的 Owner（所有者）或 Group（组）
</p>

<pre class="example">
chown fish ~/abc.txt
chown :fish_pool ~/abc.txt
</pre>
</div>
</div>

<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2"><span class="section-number-3">4.2</span> chgrp</h3>
<div class="outline-text-3" id="text-4-2">
<p>
更改用户的组
</p>

<pre class="example">
chgrp fish_pool ~/abc.txt
</pre>
</div>
</div>

<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3"><span class="section-number-3">4.3</span> groups</h3>
<div class="outline-text-3" id="text-4-3">
<p>
创建一个组：
</p>
<pre class="example">
groupadd fish_pool
</pre>

<p>
将用户 fish 和 vip 添加到组里面：
</p>
<pre class="example">
gpasswd -a fish fish_pool
gpasswd -a vip fish_pool
</pre>

<p>
将 vip 移除出去:
</p>
<pre class="example">
gpasswd -d vip fish_pool
</pre>

<p>
显示当前用户所属的组（结果是一到多个）：
</p>
<pre class="example">
groups
</pre>
</div>
</div>



<div id="outline-container-sec-4-4" class="outline-3">
<h3 id="sec-4-4"><span class="section-number-3">4.4</span> chmod</h3>
<div class="outline-text-3" id="text-4-4">
<p>
详细更改用户的权限
</p>


<p>
第一种方式，通过 +/-/= 来添加权限
</p>
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#21019;&#24314;&#19968;&#20010;&#25991;&#20214;</span>
<span style="color: #483d8b;">echo</span> <span style="color: #8b2252;">"hello, world"</span> &gt;&gt; ~/hello.txt

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#22914;&#26524;&#35753;&#36825;&#20010;&#25991;&#20214;&#25317;&#26377;&#35835;&#30340;&#26435;&#38480;</span>
chmod +r ~/hello.txt
chmod -r ~/hello.txt

chmod u+r ~/hello.txt  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25317;&#26377;&#32773;</span>
chmod g+r ~/hello.txt  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#32452;</span>
chmod o+r ~/hello.txt  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#20854;&#20182;</span>
chmod a+r ~/hello.txt  <span style="color: #b22222;"># </span><span style="color: #b22222;">&#25152;&#26377;</span>
</pre>
</div>

<p>
第二种方式，八进制。用数字去组合各种权限，r/w/x 分别用 4/2/1 来表示。
</p>
<div class="org-src-container">

<pre class="src src-sh">chmod 777 ~/hello.txt
chmod 644 ~/hello.txt
</pre>
</div>
</div>
</div>
</section>
<section id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> JDK 的安装</h2>
<div class="outline-text-2" id="text-5">
<p>
首先，选择。
</p>
<ul class="org-ul">
<li>OpenJDK
</li>
<li>Oracle JDK
</li>
</ul>
</div>

<div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1"><span class="section-number-3">5.1</span> 安装 OpenJDK</h3>
<div class="outline-text-3" id="text-5-1">
<p>
建议直接在 apt 里面安装
</p>

<p>
首先，查询：
</p>
<pre class="example">
apt-get update
apt-cache search openjdk
</pre>

<p>
其次，安装
</p>
<pre class="example">
apt-get install openjdk-7-jdk
</pre>

<p>
也可以下载其他相关的，比如，文档、示例
</p>
<pre class="example">
apt-get install openjdk-7-doc
apt-get install openjdk-7-demo
</pre>

<p>
当然，如果要卸载，需要:
</p>
<pre class="example">
apt-get remove openjdk-7-jdk
apt-get purge openjdk-7-jdk
</pre>

<p>
卸载可以跟一些选择，比如 &#x2013;purge，表示清理。自己 help 详情。
</p>

<p>
查看是否安装成功：
</p>
<pre class="example">
java -version
javac -version
whereis java
which java
</pre>
</div>
</div>
<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2"><span class="section-number-3">5.2</span> 安装 OracleJDK</h3>
<div class="outline-text-3" id="text-5-2">
<p>
总共分 2 步：
</p>
</div>
<div id="outline-container-sec-5-2-1" class="outline-4">
<h4 id="sec-5-2-1"><span class="section-number-4">5.2.1</span> 第 0 步，下载</h4>
<div class="outline-text-4" id="text-5-2-1">
<p>
注意，要下载跟自己的操作系统(Opertation System)相匹配的版本。
</p>

<p>
查看操作系统信息，可以用 uname -a 命令。
</p>

<p>
其中 x86 代表 32 位操作系统；x64 代表 64 位操作系统。
</p>
</div>
</div>

<div id="outline-container-sec-5-2-2" class="outline-4">
<h4 id="sec-5-2-2"><span class="section-number-4">5.2.2</span> 第 1 步，解压到相应目录(<i>opt</i>)</h4>
<div class="outline-text-4" id="text-5-2-2">
<p>
按照标准，建议，把所有第三方的，所有文件都在同一个文件夹内的软件，安装到 <i>opt</i> 目录。
</p>
<pre class="example">
sudo tar xzf jdk-xxx.tar.gz -C /opt/jdk1.8
</pre>
</div>
</div>

<div id="outline-container-sec-5-2-3" class="outline-4">
<h4 id="sec-5-2-3"><span class="section-number-4">5.2.3</span> 第 2 步，设置环境变量</h4>
<div class="outline-text-4" id="text-5-2-3">
<p>
在命令行下，首先，定义变量
</p>
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #b22222;">## </span><span style="color: #b22222;">&#39318;&#20808;&#65292;&#35774;&#32622; JAVA_HOME</span>
<span style="color: #a0522d;">JAVA_HOME</span>=/opt/jdk1.8
<span style="color: #483d8b;">export</span> JAVA_HOME

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#19978;&#38754;&#20004;&#21477;&#21487;&#20197;&#31616;&#20889;&#20026;</span>
<span style="color: #483d8b;">export</span> <span style="color: #a0522d;">JAVA_HOME</span>=/opt/jdk1.8


<span style="color: #b22222;">## </span><span style="color: #b22222;">&#22914;&#26524;&#65292;&#30456;&#35201;&#25226; java &#21487;&#25191;&#34892;&#25991;&#20214;&#30340;&#36335;&#24452;&#28155;&#21152;&#21040; PATH</span>
<span style="color: #483d8b;">export</span> <span style="color: #a0522d;">PATH</span>=$<span style="color: #a0522d;">JAVA_HOME</span>/bin:$<span style="color: #a0522d;">PATH</span>
</pre>
</div>

<p>
上面再命令行下运行的命令，只能在当前 terminal 里有效。如果想永久设置，将这些设置放到 ~/.bashrc 或 ~/.profile 里面。
</p>


<p>
但是，如果在系统中存在其他版本的 java，
你不想删除它，而且你想切换当前使用的版本为你刚安装的版本的话：
</p>

<p>
第一种方式：更改 PATH 变量中，路径的先后顺序。
</p>

<p>
第二种方式：利用 update-alternates 命令，设置执行程序的优先级。
</p>
<pre class="example">
update-alternatives --install /usr/bin/java java /opt/jdk1.8/bin/java 1
update-alternatives --install /usr/bin/javac javac /opt/jdk1.8/bin/javac 1
update-alternatives --config java
</pre>
<p>
这样，就可以通过修改优先级，来切换不同的版本了。
</p>
</div>
</div>

<div id="outline-container-sec-5-2-4" class="outline-4">
<h4 id="sec-5-2-4"><span class="section-number-4">5.2.4</span> All In All</h4>
<div class="outline-text-4" id="text-5-2-4">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#19979;&#36733;</span>
wget <span style="color: #707183;">[</span>jdk &#22320;&#22336;<span style="color: #707183;">]</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#35299;&#21387;</span>
sudo tar xzf jdk1.8.tar.gz -C /opt/

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#35774;&#32622; JAVA_HOME, "vi .bashrc"</span>
<span style="color: #a0522d;">JAVA_HOME</span>=/opt/jdk1.8.0_121
<span style="color: #a0522d;">PATH</span>=$<span style="color: #a0522d;">JAVA_HOME</span>/bin:$<span style="color: #a0522d;">PATH</span>
<span style="color: #a0522d;">CLASSPATH</span>=$<span style="color: #a0522d;">JAVA_HOME</span>/lib/dt.jar:$<span style="color: #a0522d;">JAVA_HOME</span>/lib/tools.jar
</pre>
</div>
</div>
</div>
</div>
</section>

<section id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> Tomcat 的安装</h2>
<div class="outline-text-2" id="text-6">
</div><div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1"><span class="section-number-3">6.1</span> 手动安装</h3>
<div class="outline-text-3" id="text-6-1">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #b22222;"># </span><span style="color: #b22222;">&#31532; 0 &#27493;&#65306;&#19979;&#36733;</span>
wget http://mirrors.hust.edu.cn/apache/tomcat/tomcat-7/v7.0.76/bin/apache-tomcat-7.0.76.tar.gz

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#31532; 1 &#27493;&#65306;&#35299;&#21387;</span>
sudo tar xf apache-tomcat-7.0.76 -C /opt/

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#31532; 2 &#27493;&#65306;&#37197;&#32622;&#29615;&#22659;&#21464;&#37327;</span>
<span style="color: #483d8b;">echo</span> <span style="color: #8b2252;">"CATALINA_HOME=/opt/apache-tomcat-7.0.76"</span> &gt;&gt; ~/.bashrc
source ~/.bashrc

<span style="color: #b22222;"># </span><span style="color: #b22222;">&#31532; 3 &#27493;&#65306;&#21551;&#21160;</span>
sudo $<span style="color: #a0522d;">CATALINA_HOME</span>/bin/startup.sh
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-6-2" class="outline-3">
<h3 id="sec-6-2"><span class="section-number-3">6.2</span> apt 方式安装</h3>
<div class="outline-text-3" id="text-6-2">
<p>
第一步，安装：
</p>
<pre class="example">
sudo apt-get install tomcat7
</pre>

<p>
第二部，启动：
</p>
<pre class="example">
service tomcat7 start
service tomcat7 stop/restart/status

# 作为一些新的系统，底层控制已换成 systemd，那么可以使用下面命令。跟上面等效:
systemctl start/restart/stop/status tomcat7
systemctl enable/disable tomcat7    # 设置是否开机启动
</pre>

<p>
第三步，安装其他：
</p>
<pre class="example">
sudo apt-get install tomcat7-docs
sudo apt-get install tomcat7-examples
sudo apt-get isntall tomcat7-admin
</pre>
</div>
</div>
</section>
<section id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7"><span class="section-number-2">7</span> Tomcat 的基本概念</h2>
<div class="outline-text-2" id="text-7">
<p>
Tomcat 服务器由四大部分组成：
</p>
<ol class="org-ol">
<li>Coyote   : 用来监听网络，接收请求，交给相应的 Catalina 处理，并将结果返回到客户端
</li>
<li>Catalina : 实现了 J2EE 标准的 Servlet 容器，用来执行调用 Servlet。它是 tomcat 最核心的部分。
</li>
<li>Jasper   : 用来将 jsp 翻译成相应的 Servlet
</li>
<li>Cluster  : 当配置集群的时候才会有用。进行集群管理。
</li>
</ol>

<p>
<b>注意：</b>
</p>
<ul class="org-ul">
<li>tomcat 是一个服务器，它包含基本的网络处理，还有通过内置的 Servlet 容器完成对 servlet 的处理
</li>
<li>tomcat 在 4.* 版本后，对容器做了重新设定，新设定的容器名字命名为 catalina，一直沿用到现在。
</li>
<li>在设置环境变量的时候，只有 CATALINA_HOME，并没有 TOMCAT_HOME。因为我们设定的是 Servlet 容器的目录。
</li>
</ul>


<p>
在 server.xml 中，分下面几个层次
</p>
<ul class="org-ul">
<li>Server
<ul class="org-ul">
<li>Service (一个服务是若干 Connector 和 Engine 的集合。 Connector 用来处理网络， Engine 用来执行功能)
<ul class="org-ul">
<li>Connector (用于监听网络，并将相应的请求发送给相应 Engine)
</li>
<li>Engine (一个引擎里里面包含若干 Host&lt;本机可以多 IP，所以根据不同的 IP 地址访问不同项目&gt;，每个 Host 包含部署的若干项目即 Context)
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</section>



<section id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8"><span class="section-number-2">8</span> Tomcat 下的文件部署</h2>
<div class="outline-text-2" id="text-8">
<p>
在部署之前，先弄懂几个概念：
</p>
<ul class="org-ul">
<li>CATALINA
</li>
<li>CATALINA_HOME 环境变量（什么意思，占位）
</li>
<li>CATALINA_BASE 环境变量（什么意思，占位）
</li>
</ul>

<p>
如果是手动安装的：
</p>
<pre class="example">
CATALINA_HOME=/opt/apache-tomcat-7
CATALINA_BASE=/opt/apache-tomcat-7
</pre>

<p>
如果是 APT 安装的：
</p>
<pre class="example">
CATALINA_HOME=/usr/share/tomcat7
CATALINA_BASE=/var/lib/tomcat7
</pre>


<p>
拿手动安装的示例，说明 CATALINA_BASE 下各文件夹的作用：
</p>
<ul class="org-ul">
<li>bin 文件夹，放置的是启动关闭等的可执行脚本文件
</li>
<li>lib 文件夹，运行所需要的 jar 包
</li>
<li>logs 日志文件夹，保存了运行中的各种日志。如果系统运行中出现问题，我们首先要想到来这个文件夹查看相应出错信息。
</li>
<li>conf 文件夹，所有的配置文件
</li>
<li>webapps 默认的项目存放文件夹。如果把 war 项目放到下面，会自动被服务器加载。
</li>
<li>work 程序运行中编译的中间文件存放于此。比如，jsp 编译成的 servlet.
</li>
</ul>


<p>
如果想部署项目，下面几种方法:
</p>
</div>
<div id="outline-container-sec-8-1" class="outline-3">
<h3 id="sec-8-1"><span class="section-number-3">8.1</span> 将符合 war 标准的文件夹或 .war 文件直接放置到 webapps 下面</h3>
</div>
<div id="outline-container-sec-8-2" class="outline-3">
<h3 id="sec-8-2"><span class="section-number-3">8.2</span> 修改配置文件，设置 Context</h3>
<div class="outline-text-3" id="text-8-2">
<p>
下面几种方法，分别对应不同的级别:
</p>
<ol class="org-ol">
<li>修改 conf/server.xml，增加或修改 Context 节点
</li>
<li>修改 conf/context.xml，增加相应内容
</li>
<li>修改或增加 conf/Catalina/主机名/context.xml，增加相应内容
</li>
<li>修改或增加 conf/Catalina/主机名/名字.xml，增加相应内容
</li>
</ol>

<p>
如果你们装了 tomcat7-examples 等，你们可以看一下 conf/Catalina/localhost 文件夹下面是不是已经存在了相应的 xml 文件？
这就是为什么我们能在 tomcat 启动后访问到他们的原因。
</p>
</div>
</div>

<div id="outline-container-sec-8-3" class="outline-3">
<h3 id="sec-8-3"><span class="section-number-3">8.3</span> 使用 Tomcat 提供的 Admin 管理</h3>
<div class="outline-text-3" id="text-8-3">
<p>
首先，确保已经安装了 tomcat-admin。
tomcat-admin 也是一个标准的 web 工程，安装完后，它存在于 /usr/share/tomcat7-admin 文件夹。
</p>
<pre class="example">
apt install tomcat7-admin
</pre>

<p>
其次，如果使用 admin 进行管理，需要登陆验证。所以我们需要添加一个用户。在 conf/tomcat-users.xml 中添加：
</p>
<div class="org-src-container">

<pre class="src src-xml">&lt;<span style="color: #0000ff;">role</span> <span style="color: #a0522d;">rolename</span>=<span style="color: #8b2252;">"</span><span style="color: #8b2252;">manager-gui</span><span style="color: #8b2252;">"</span>/&gt;
&lt;<span style="color: #0000ff;">user</span> <span style="color: #a0522d;">username</span>=<span style="color: #8b2252;">"</span><span style="color: #8b2252;">&#29992;&#25143;&#21517;</span><span style="color: #8b2252;">"</span> <span style="color: #a0522d;">password</span>=<span style="color: #8b2252;">"</span><span style="color: #8b2252;">&#23494;&#30721;</span><span style="color: #8b2252;">"</span> <span style="color: #a0522d;">roles</span>=<span style="color: #8b2252;">"</span><span style="color: #8b2252;">manager-gui</span><span style="color: #8b2252;">"</span>/&gt;
</pre>
</div>

<p>
然后，访问 localhost:8080/manager/html 就可以进入控制台，在上面进行查看并部署了。
</p>
</div>
</div>
</section>
</div>
<div id="postamble" class="status">
<p class="author">Author: imfine</p>
<p class="date">Created: 2017-03-21 周二 10:58</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.1.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation">Go ahead, never stop.</p>
</div>
</body>
</html>
